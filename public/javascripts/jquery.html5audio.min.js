(function(e){e.fn.html5audio=function(k){function g(){var a=0==h.find("div[class='fontMeasure']").length?e("<div/>").addClass("fontMeasure").appendTo(h):h.find("div[class='fontMeasure']");Y=new apTextScroller;Y.init(a,Na,od,"left",k.scrollSeparator,k.scrollSpeed)}function F(){G&&clearTimeout(G);O.css("display","none");ib=!1}function Ca(a){if(l&&!q&&!ea){if(!jb){if("touchstart"==a.type){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();jb=!0;pa.on(Oa,function(a){a:{var b;
if("touchmove"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a.originalEvent;a.preventDefault();L(b)}}).on(Pa,function(a){a:if(jb){jb=!1;pa.off(Oa).off(Pa);var b;if("touchend"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&
a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a.originalEvent;a.preventDefault();L(b)}})}return!1}}function L(a){"horizontal"==kb?w=Math.max(0,Math.min(1,(a.pageX-Qa.offset().left)/P)):(w=Math.max(0,Math.min(1,(a.pageY-Qa.offset().top)/P)),w=1-w);fa()}function H(){if(!l||q)return!1;Fb?(w=Yb,Fb=!1):(Yb=w,w=0,Fb=!0)}function fa(){"horizontal"==kb?Gb.css("width",w*P+"px"):Gb.css("height",w*P+"px");U&&m&&(m.volume=w);0<w?h.find(".player_volume").find("img").attr("src",
Bc):h.find(".player_volume").find("img").attr("src",Cc);isMobile&&lb&&(G&&clearTimeout(G),G=setTimeout(F,Hb))}function qa(){lb&&G&&clearTimeout(G);ga.css("display","block");O.on("mousemove",Ra).on("mouseout",Q);pa.on("mouseout",Q)}function Q(){lb&&(G&&clearTimeout(G),G=setTimeout(F,Hb));ga.css("display","none");O.off("mousemove",Ra).off("mouseout",Q);pa.off("mouseout",Q)}function Ra(a){if("horizontal"==kb){var b=a.pageX-Qa.offset().left;if(!z(b))return!1;0>b?b=0:b>P&&(b=P);a=parseInt(a.pageX-O.offset().left-
ga.width()/2,10);ga.css("left",a+"px");b=Math.max(0,Math.min(1,b/P));b=parseInt(100*b,10)}else{b=a.pageY-Qa.offset().top;if(!z(b))return!1;0>b?b=0:b>P&&(b=P);a=parseInt(b-ga.height()/2,10);ga.css("top",a+pd+"px");b=Math.max(0,Math.min(1,b/P));b=parseInt(100*(1-b),10)}ga.find("p").html(b+" %")}function Sa(a){if(l&&!q&&U&&!jb&&!Dc){if(!ea){if("touchstart"==a.type){if(a=a.originalEvent.touches,!(a&&0<a.length))return!1}else a.preventDefault();ea=!0;pa.on(Oa,function(a){a:{var b;if("touchmove"==a.type){if(a.originalEvent.touches&&
a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;else break a;if(1<b.length)break a;b=b[0]}else b=a;a.preventDefault();Ta(b,a)}}).on(Pa,function(a){a:if(ea){ea=!1;pa.off(Oa).off(Pa);var b;if("touchend"==a.type){if(a.originalEvent.touches&&a.originalEvent.touches.length)b=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)b=a.originalEvent.changedTouches;
else break a;if(1<b.length)break a;b=b[0]}else b=a;a.preventDefault();Ta(b,a)}})}return!1}}function Ta(a,b){if(!ha){Da=a.pageX-Ib.offset().left;0>Da?Da=0:Da>V&&(Da=V);Ea.width(Da);var c=Math.max(0,Math.min(1,Da/V))}else if(ia){if(Zb(b)){if(Jb||$b>ac-Ec)return!1;ea||(mb(!0),A.clearRect(0,0,M,R),Ua(ja),Va());return!1}if(!Jb)return!1;var c=a.pageX-ka.offset().left-M/2,f=a.pageY-ka.offset().top-R/2,c=Math.atan2(f,c);c>-1*Math.PI&&c<-.5*Math.PI&&(c=2*Math.PI+c);ja=c=Math.max(0,Math.min((c+Math.PI/2)/2*
Math.PI*10))/100;A.clearRect(0,0,M,R);Ua(ja);Va()}if(!z(c))return!1;nb=ja;m&&m.seekable&&0<m.seekable.length&&(!qd||isMobile?m.currentTime=c*m.duration:c*m.duration>=m.buffered.end(0)-5?m.currentTime=m.buffered.end(0)-5:m.currentTime=c*m.duration)}function ra(){U&&(la.css("display","block"),ya.on("mousemove",Fc).on("mouseout",Fa),pa.on("mouseout",Fa))}function Fa(){U&&(la.css("display","none"),ya.off("mousemove",Fc).off("mouseout",Fa),pa.off("mouseout",Fa))}function Fc(a){if(!ha){var b=a.pageX-Ib.offset().left;
if(!z(b))return!1;0>b?b=0:b>V&&(b=V);a=parseInt(a.pageX-ya.offset().left-la.width()/2,10);la.css("left",a+"px");b=Math.max(0,Math.min(1,b/V))}else if(ia){if(Zb(a))return la.css("display","none"),!1;b=a.pageX-ka.offset().left;a=a.pageY-ka.offset().top;a=Math.atan2(a-R/2,b-M/2);a>-1*Math.PI&&a<-.5*Math.PI&&(a=2*Math.PI+a);b=Math.max(0,Math.min((a+Math.PI/2)/2*Math.PI*10))/100;la.css("display","block")}if(!z(b))return!1;a=b;if(z(a)){var c,f;m&&(f=m.duration,c=a*f);z(c)&&z(f)&&la.find("p").html(Gc(c)+
Hc+Ic(f))}}function Ua(a){A.beginPath();A.arc(M/2,R/2,bc-ob/2,-Kb,Jc*a-Kb,!1);A.strokeStyle=cc;A.lineCap="butt";A.lineWidth=ob;A.stroke()}function Va(){if(B)a=62,b=57,A.fillStyle=cc,A.fillRect(a,b,14,45),A.fillRect(a+23,b,14,45);else{var a=65,b=57,c=65-a,f=102-b,d=Math.atan2(f,c)-Math.PI/3,f=Math.sqrt(c*c+f*f),c=Math.cos(d)*f+a,d=Math.sin(d)*f+b;A.beginPath();A.fillStyle=cc;A.moveTo(a,b);A.lineTo(65,102);A.lineTo(c,d);A.fill()}}function Zb(a){var b;if("touchstart"==a.type){if(a.originalEvent.touches&&
a.originalEvent.touches.length)a=a.originalEvent.touches;else if(a.originalEvent.changedTouches&&a.originalEvent.changedTouches.length)a=a.originalEvent.changedTouches;else return!1;if(1<a.length)return!1;b=a[0]}else b=a.originalEvent;a=b.pageX-ka.offset().left;b=b.pageY-ka.offset().top;var c=M/2,f=R/2;$b=Math.sqrt((a-c)*(a-c)+(b-f)*(b-f));return Math.sqrt((a-c)*(a-c)+(b-f)*(b-f))<ac}function dc(a){if(0!=h.find(".componentPlaylist").length)if(I)"vertical"==pb?ma.outerHeight(!0)>=Wa.height()?(I.reinitialise(),
a&&(I.scrollToY(0),e(".jspPane").css("top","0px"))):(I.destroy(),I=null):(I.reinitialise(),a&&(I.scrollToX(0),e(".jspPane").css("left","0px")));else if(a=h.find(".componentPlaylist"),I=a.jScrollPane().data().jsp,a.on("jsp-initialised",function(a,c){}).jScrollPane({mouseWheelSpeed:20}),"horizontal"==pb&&!isMobile)a.on("mousewheel",rd)}function rd(a,b,c,f){if(!l||q)return!1;I&&I.scrollByX(100*(0<b?-1:1));return!1}function mb(a){B?(m&&m.pause(),B=!1,sa("off")):(m&&m.play(),B=!0,qb("off"));if(!a)return!1}
function Kc(a){if(!l||q)return!1;a.preventDefault();a=e(a.currentTarget);var b=a.attr("data-id");if(a.closest(".playlistItem").hasClass("playlist_locked"))return!1;Z=!0;na();n.processPlaylistRequest(b)}function sd(a){if(!l||q)return!1;a.preventDefault();a=e(a.currentTarget).attr("class").split(" ");if(-1!=e.inArray("controls_prev",a))Z=!0,na(),n.advanceHandler(-1,!0);else if(-1!=e.inArray("controls_toggle",a))U&&mb();else if(-1!=e.inArray("controls_next",a))Z=!0,na(),n.advanceHandler(1,!0);else if(-1!=
e.inArray("player_volume",a))isMobile?lb?(G&&clearTimeout(G),ib?(O.css("display","none"),ib=!1):(O.css("display","block"),ib=!0,G=setTimeout(F,Hb))):(H(),fa()):(H(),fa());else if(-1!=e.inArray("player_download",a)){if(!Lb&&!ta)if(a=Mb){var b=n.getCounter(),c=v[b].download,b=ec(b,!1);a=Lc(a,b,c);Mc(a.name,a.path)}else t&&alert("Invalid data-type for file download function! Quitting."),ta=!1}else-1!=e.inArray("player_loop",a)?(aa?(h.find(".player_loop").find("img").attr("src",Nb),aa=!1):(h.find(".player_loop").find("img").attr("src",
rb),aa=!0),n.setLooping(aa)):-1!=e.inArray("player_shuffle",a)&&(ba?(h.find(".player_shuffle").find("img").attr("src",Ob),ba=!1):(h.find(".player_shuffle").find("img").attr("src",sb),ba=!0),n.setRandom(ba))}function td(a){l&&(a.preventDefault(),a=e(a.currentTarget).attr("class").split(" "),-1!=e.inArray("controls_prev",a)?h.find(".controls_prev").find("img").attr("src",ud):-1!=e.inArray("controls_toggle",a)?B?qb("on"):sa("on"):-1!=e.inArray("controls_next",a)?h.find(".controls_next").find("img").attr("src",
vd):-1!=e.inArray("player_volume",a)?0<w?h.find(".player_volume").find("img").attr("src",wd):h.find(".player_volume").find("img").attr("src",xd):-1!=e.inArray("player_download",a)?h.find(".player_download").find("img").attr("src",yd):-1!=e.inArray("player_loop",a)?aa?h.find(".player_loop").find("img").attr("src",Nb):h.find(".player_loop").find("img").attr("src",rb):-1!=e.inArray("player_shuffle",a)&&(ba?h.find(".player_shuffle").find("img").attr("src",Ob):h.find(".player_shuffle").find("img").attr("src",
sb)))}function zd(a){l&&(a.preventDefault(),a=e(a.currentTarget).attr("class").split(" "),-1!=e.inArray("controls_prev",a)?h.find(".controls_prev").find("img").attr("src",Ad):-1!=e.inArray("controls_toggle",a)?B?qb("off"):sa("off"):-1!=e.inArray("controls_next",a)?h.find(".controls_next").find("img").attr("src",Bd):-1!=e.inArray("player_volume",a)?0<w?h.find(".player_volume").find("img").attr("src",Bc):h.find(".player_volume").find("img").attr("src",Cc):-1!=e.inArray("player_download",a)?h.find(".player_download").find("img").attr("src",
Cd):-1!=e.inArray("player_loop",a)?aa?h.find(".player_loop").find("img").attr("src",rb):h.find(".player_loop").find("img").attr("src",Nb):-1!=e.inArray("player_shuffle",a)&&(ba?h.find(".player_shuffle").find("img").attr("src",sb):h.find(".player_shuffle").find("img").attr("src",Ob)))}function na(){if(!W&&-1!=n.getCounter()){var a=e(ua[n.getCounter()]);if(a&&a.hasClass("playlistSelected")){var b=a.attr("data-id");a.removeClass("playlistSelected").addClass("playlistNonSelected");"undefined"!==typeof playlistItemEnabled&&
playlistItemEnabled(C,J,a,b)}}}function Nc(){if(!W){var a=e(ua[n.getCounter()]);if(a&&a.hasClass("playlistNonSelected")){var b=a.attr("data-id");a.removeClass("playlistNonSelected").addClass("playlistSelected");"undefined"!==typeof playlistItemDisabled&&playlistItemDisabled(C,J,a,b)}}}function fc(){var a=k.activeItem;z(a)&&-1!=a?(0>a?a=0:a>x-1&&(a=x-1),n.setCounter(a,!1)):Z=!0}function Oc(){p&&-1!=n.getCounter()&&(tb(),Pc(),na())}function ub(){tb();Pc();var a=0,b;for(a;a<x;a++)b=e(ua[a]).off("click",
Kc),Qc&&!isMobile&&b.off("mouseenter").off("mouseleave");p&&(p.children().each(function(){var a=e(this);a.data("hap_wrap_player")&&a.data("hap_wrap_player").destroyPlaylist()}),p.empty(),p=null);ma.empty();W=vb=!1;wb=N=u=null;Xa=Ya=xb=!1;Za=null;n.reSetCounter();v=[];ua=[];E=[];I&&I.reinitialise()}function tb(){va&&clearInterval(va);m&&(m.pause(),m.src="");yb&&yb.off("ended pause play canplay canplaythrough loadedmetadata error");gc();wb?Ga.css("display","block"):Ga.css("display","none");nb=null;
hc=U=B=Dc=!1;ic||(zb=void 0)}function Rc(a){if("undefined"===typeof a)return t&&alert("setPlaylist method requires data parameter. loadPlaylist failed."),!1;if("undefined"===typeof a.hidden)return t&&alert("setPlaylist method requires data.hidden parameter. loadPlaylist failed."),!1;var b=Dd(a.hidden);if("undefined"===typeof a.id)return t&&alert("setPlaylist method requires data.id parameter. loadPlaylist failed."),!1;a=a.id;q=!0;Sc||(Sc=!0);Tc();ma.css("opacity",0);p&&ub();vb=!1;W=b;Uc&&isIE?(b=
e(za.find(a).css("display","block").clone().wrap("<p>").parent().html()),e(za.find(a).css("display","none"))):(b=za.find(a).css("display","block").clone(),za.find(a).css("display","none"));b.css("fontSize",0);if(0==b.length)return t&&alert('Failed to select playlist! Make sure that element: "'+a+'" exist in playlist list! Quitting.'),jc(),!1;if(W)$a.empty(),b.appendTo($a),ca=0,Xa=Ya=Ha=!0,p=kc;else{if(!I&&0==ma.length)return t&&alert("playlist_inner html element seems to be missing! You could be trying to use loadPlaylist method without having necessary html elements inside componentWrapper. Quitting."),
!1;b.appendTo(ma);p=b}v=[];ua=[];E=[];y=[];b.find("li[class*='playlistItem']").each(function(){y.push(e(this))});K()}function K(){y.length?Ed():Fd()}function Ed(){Ab=S=T=N=oa=null;lc=!1;var a=y[0],b=a.attr("data-type").toLowerCase(),c=a.attr("data-path"),f=a.hasClass("hap_processed");r=[];a.hasClass("hap_draggable")&&(lc=!0);void 0==a.attr("data-plink")||D(a.attr("data-plink"))||(oa=a.attr("data-plink"));void 0!=a.attr("data-dlink")&&(N=D(a.attr("data-dlink"))?!0:a.attr("data-dlink"));void 0!=a.attr("data-download")&&
(T=D(a.attr("data-download"))?!0:a.attr("data-download"));void 0==a.attr("data-thumb")||D(a.attr("data-thumb"))||(S=a.attr("data-thumb"));D(e.trim(a.html()))||(Ab=a.html());if(f)u=a,y.shift(),K();else if("local"==b)u=a,y.shift(),K();else if("soundcloud"==b)u=a.data("toremove","true"),Pb=0,Qb(c);else if("podcast"==b)u=a.data("toremove","true"),f=Gd+"?url="+encodeURIComponent(c),e.ajax({url:f,dataType:"json",cache:!1}).done(function(a){if(ieBelow9){a=Hd(a.contents);var b,c=0;e(a).find("item").each(function(){if(c==
mc)return!1;b=e(this);g={type:"podcast"};g.mp3=b.find("enclosure").attr("url");g.title=b.find("title").text();0<b.find("media\\:thumbnail").length?b.find("media\\:thumbnail").attr("url")?g.thumb=b.find("media\\:thumbnail").attr("url"):S&&(g.thumb=S):S&&(g.thumb=S);oa&&(g.url=oa);N&&(g.dlink=N);T&&(g.download=T);r.push(g);c++})}else{Vc.html(a.contents);a=Vc.get(0).getElementsByTagName("item");var f=0,c=a.length,d,h,g;c>mc&&(c=mc);for(f;f<c;f++)d=a[f],void 0!=d.getElementsByTagName("enclosure")[0]&&
(g={type:"podcast"},g.mp3=d.getElementsByTagName("enclosure")[0].getAttribute("url"),void 0!=d.getElementsByTagName("itunes:duration")[0]&&(h=Id(d.getElementsByTagName("itunes:duration")[0].childNodes[0].nodeValue),g.length=parseInt(1E3*h,10)),void 0!=d.getElementsByTagName("media:thumbnail")[0]?void 0!=d.getElementsByTagName("media:thumbnail")[0].getAttribute("url")?g.thumb=d.getElementsByTagName("media:thumbnail")[0].getAttribute("url"):S&&(g.thumb=S):S&&(g.thumb=S),g.title=d.getElementsByTagName("title")[0].childNodes[0].nodeValue,
oa&&(g.url=oa),N&&(g.dlink=N),T&&(g.download=T),r.push(g))}Ia()}).fail(function(a,b,f){t&&alert("Parse feed error: "+a.responseText);t&&alert("Playlist process failed, podcast: "+c);u&&"true"==u.data("toremove")&&u.remove();y.shift();K()});else if("folder"==b){u=a.data("toremove","true");var f=hap_source_path+"folder_parser.php",d=!0;void 0!=a.attr("data-subdirs")&&"false"==a.attr("data-subdirs")&&(d=!1);d={dir:c,subdirs:d};e.ajax({type:"GET",url:f,data:d,dataType:"json"}).done(function(a){Jd(a,"title");
var b=0,c=a.length,f,d;Wc&&(Aa=r.length?r.length-1:0);for(b;b<c;b++)if(f=a[b],d=f.path,d=d.replace(/\\'/g,"'"),d=d.replace(/\\"/g,'"'),d=d.replace(/\\0/g,"\x00"),path=d=d.replace(/\\\\/g,"\\"),d={type:"folder"},/.mp3/.test(path)){d.mp3=path;var e=path.substr(0,path.lastIndexOf("."));title=/\//i.test(e)?e.substr(e.lastIndexOf("/")+1):e;title=title.split("_").join(" ");d.title=title;d.thumb=path.substr(0,path.lastIndexOf("."))+".jpg";d.size=parseInt(f.size,10);d.lastmod=parseInt(f.lastmod,10);oa&&(d.url=
oa);N&&(d.dlink=N);T&&(d.download=T);S&&(d.thumb=S);r.push(d)}r.length&&Wc?Xc():Ia()}).fail(function(a,b,d){t&&alert("Read folder error! Make sure you run this online or on local server!");t&&alert("Playlist process failed, folder: "+c);u&&"true"==u.data("toremove")&&u.remove();y.shift();K()})}else if("xml"==b){u=a;var f=hap_source_path+c,h,g=[];e.ajax({type:"GET",url:f,dataType:"html",cache:!1}).done(function(b){y.shift();e(b).find("li[class='playlistItem']").each(function(){h=nc(e(this));u?u.after(e(h)):
0<p.children().length?e(h).prependTo(p):e(h).appendTo(p);u=e(h);g.push(e(h))});b=0;var c=g.length;g.reverse();for(b;b<c;b++)y.unshift(g[b]);g=null;a.remove();K()}).fail(function(a,b,d){t&&alert("Playlist process failed, xml: "+c);u&&u.remove();y.shift();K()})}else if("database_data"==b||"database_html"==b)if(void 0==a.attr("data-table")||D(a.attr("data-table")))t&&(alert("Database table missing!"),alert("Playlist process failed, database query: "+c)),y.shift(),K();else{var k=d=null,m=null;void 0==
a.attr("data-limit")||D(a.attr("data-limit"))||(d=parseInt(a.attr("data-limit"),10));void 0==a.attr("data-range")||D(a.attr("data-range"))||(f=a.attr("data-range").split(","),2==f.length&&(k=f[0],m=f[1]));u=a;f=hap_source_path+"includes/database.php";g=[];d={db_name:c,db_table:a.attr("data-table"),db_type:b,limit:d,range_from:k,range_to:m};e.ajax({type:"POST",url:f,data:d}).done(function(d){if(-1<d.indexOf("Database information missing!")||-1<d.indexOf("Db connection failed")||-1<d.indexOf("Db selection failed")||
-1<d.indexOf("Db query failed"))t&&(alert(d),alert("Playlist process failed, database query: "+c)),u&&u.remove(),y.shift();else{y.shift();d=e.parseJSON(d);var f=0,k=d.length,m;for(f;f<k;f++){m=d[f];if("database_data"==b)if(m.type&&m.mp3||m.path)h=Yc(m);else continue;else if(m.path)h=nc(m.path);else continue;u?u.after(e(h)):0<p.children().length?e(h).prependTo(p):e(h).appendTo(p);u=e(h);g.push(e(h))}f=0;k=g.length;g.reverse();for(f;f<k;f++)y.unshift(g[f]);g=null;a.remove()}K()}).fail(function(a,b,
d){t&&alert("Playlist process failed, database query: "+c);u&&u.remove();y.shift();K()})}else t&&alert("Invalid playlist data-type attribute!"),y.shift(),K()}function Ia(){if(r.length){var a,b,c=0,f=r.length,d,g;for(c;c<f;c++)d=r[c],a=e('<li class="playlistItem" data-type="'+d.type+'"data-mp3="'+d.mp3+'" data-thumb="'+d.thumb+'"></li>'),g=d.mp3,/\.(mp3)$/i.test(d.mp3)||(g+=".mp3"),lc&&a.addClass("hap_draggable"),d.url&&a.attr("data-plink",d.url),d.dlink&&(1!=d.dlink&&"true"!=d.dlink?a.attr("data-dlink",
d.dlink):a.attr("data-dlink",g)),d.download&&(1!=d.download&&"true"!=d.download?a.attr("data-download",d.download):a.attr("data-download",g)),d.title&&a.attr("data-title",d.title),d.thumb&&("//"==d.thumb.substr(0,2)&&(d.thumb="http:"+d.thumb),a.attr("data-thumb",d.thumb)),d.length&&a.attr("data-length",d.length),"title"==wa?b=e('<a class="playlistNonSelected" href="#">'+d.title+"</a>").appendTo(a):"thumb"==wa?b=e('<a class="playlistNonSelected" href="#"><img src="'+d.thumb+'" alt="thumb"/></a>').appendTo(a):
"all"==wa&&(b=e('<a class="playlistNonSelected" href="#"></a>').appendTo(a),e('<span class="hap_thumb"><img src="'+d.thumb+'" alt="thumb"/></span>').appendTo(b),e('<span class="hap_title"><p>'+d.title+"</p></span>").appendTo(b)),Ab&&b.after(Ab),u?(u.after(a),"true"==u.data("toremove")&&u.remove()):a.appendTo(p),u=a}y.shift();K()}function Fd(){if(xb||Ya){var a=0;u=null;var b;$a.find("li[class*='playlistItem']").each(function(){b=e(this);u?u.after(b):Ha?b.appendTo(p):p.children().eq(ca).before(b);u=
b;a++});$a.empty()}Rb();ma.css("opacity",1);l||Zc();Ab=u=null;q=!1;jc();if(0<x){if(xb||Ya){var c=n.getCounter();n.setPlaylistItems(x,!1);ca<=c&&(Ha||n.reSetCounter(c+a));Xa&&(Xa=!1,fc())}else n.setPlaylistItems(x),fc();Ja&&xa()}Ya=xb=!1;0==x&&"undefined"!==typeof playlistEmpty&&playlistEmpty(C,J);"undefined"!==typeof audioPlayerPlaylistLoaded&&audioPlayerPlaylistLoaded(C,J);vb=!0}function Rb(){v=[];E=[];ua=[];if(0==p.length)return t&&alert("lastPlaylist html element seems to be missing! You could be trying to use addTrack method without having necessary html elements inside componentWrapper. Quitting."),
!1;var a=0,b,c,f=p.find("li"),d=f.length,g,h,k,m,Bb,u,r,F,w;Cb=0;for(a;a<d;a++){c=e(f[a]).addClass("hap_processed");E.push(c);oc&&c.addClass("playlist_locked");Cb="horizontal"==pb?Cb+c.outerWidth(!0):Cb+c.outerHeight(!0);b=c.find("a[class=playlistNonSelected]");0==b.length&&(b=c.find("a[class=playlistSelected]"));b.off().on("click",Kc).attr("data-id",a);ua.push(b);if(Qc&&!isMobile)b.on("mouseenter",function(a){if(!l||q)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&
a.stopPropagation();a=e(a.currentTarget).attr("data-id");var b=e(ua[a]),c=!1;n.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollover&&playlistItemRollover(C,J,b,a,c);return!1}).on("mouseleave",function(a){if(!l||q)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=e(a.currentTarget).attr("data-id");var b=e(ua[a]),c=!1;n.getCounter()==a&&(c=!0);"undefined"!==typeof playlistItemRollout&&playlistItemRollout(C,J,b,a,c);return!1});g="";void 0!=
c.attr("data-title")?g=c.attr("data-title"):"title"==wa?g=b.html():"thumb"!=wa&&"all"==wa&&(g=b.find("span[class=hap_title]").find("p").html());pc&&(h=qc(a)+rc+g,b.html(h));c=e(E[a]).attr({"data-id":a,"data-title":g});k=h=Bb="";m=void 0;w=F=r=u=null;void 0!=c.attr("data-mp3")&&(Bb=c.attr("data-mp3"));void 0!=c.attr("data-type")&&(h=c.attr("data-type"));void 0!=c.attr("data-origtype")&&(k=c.attr("data-origtype"));void 0==c.attr("data-length")||D(c.attr("data-length"))||(m=c.attr("data-length"));void 0!=
c.attr("data-download")&&(r=D(c.attr("data-download"))||"true"==c.attr("data-download")?u=Bb:u=c.attr("data-download"));void 0!=c.attr("data-dlink")&&(r=D(c.attr("data-dlink"))||"true"==c.attr("data-dlink")?Bb:c.attr("data-dlink"));void 0==c.attr("data-plink")||D(c.attr("data-plink"))||(F=c.attr("data-plink"));void 0==c.attr("data-thumb")||D(c.attr("data-thumb"))||(w=c.attr("data-thumb"));W||(F&&0==c.find("a[class=plink]").length&&(F=e('<a class="plink" href="'+F+'" target="_blank"><img src="'+$c+
'" alt="purchase"/></a>'),b.after(F)),r&&(Lb?0==c.find("a[class=dlink]").length&&(r=e('<a class="dlink" href="'+r+'" download><img src="'+sc+'" alt="download"/></a>'),b.after(r)):0==c.find("a[class=dlink]").length&&(r=e('<a class="dlink" href="#" data-dlink="'+r+'"><img src="'+sc+'" alt="download"/></a>'),b.after(r),D(c.attr("data-dlink")))),ad&&0==c.find("a[class=premove]").length&&(c=e('<a class="premove" href="#"><img src="'+Kd+'" alt="remove"/></a>'),b.after(c)));v.push({id:a,type:h,origtype:k,
title:g,mp3:Bb,length:m,download:u,thumb:w})}f=null;x=v.length;W||(Ld(),Md&&Wa.length&&!p.hasClass("ui-sortable")&&(p.on("sortstart",function(a,b){b.helper.css("margin-top",bd.scrollTop())}),p.on("sortbeforestop",function(a,b){b.helper.css("margin-top",0)}),p.sortable({cursor:"move",update:function(a,b){Rb();0<x&&n.setPlaylistItems(x);var c=ma.find("a[class=playlistSelected]").attr("data-id");c&&(n.reSetCounter(c),Ja&&xa());1==x&&fc()},receive:function(a,b){"undefined"!==typeof dropReceive&&dropReceive(C,
J)}})),cd&&("horizontal"==pb&&ma.width(Cb),dc(!0)));return!0}function Zc(){l=!0;q=!1;jc();setTimeout(function(){dd();"horizontal"==kb?(P=Qa.width(),Gb.css("width",w*P+"px")):(P=Qa.height(),Gb.css("height",w*P+"px"));fa()},100);"undefined"!==typeof audioPlayerSetupDone&&audioPlayerSetupDone(C,J)}function Ld(){var a=Sb?ab:"click";if(Lb)h.find("a[class=dlink]").each(function(a){a=e(this);a.attr("href",a.attr("data-dlink")).attr("download","")});else h.find("a[class=dlink]").off().on(a,function(a){a.preventDefault();
if(ta)return!1;var b=e(this),f=b.closest(".playlistItem"),d=f.attr("data-id");if(f.hasClass("playlist_locked"))return!1;if(void 0==f.attr("data-type")||D(f.attr("data-type")))return t&&alert("Invalid data-type for file download function! Quitting."),ta=!1;a=f.attr("data-type");void 0==f.attr("data-origtype")||D(f.attr("data-origtype"))||(a=f.attr("data-origtype"));void 0==b.attr("data-dlink")||D(b.attr("data-dlink"))||(b=b.attr("data-dlink"),d=ec(d,!1),a=Lc(a,d,b),Mc(a.name,a.path))});h.find("a[class=plink]").off().on("click",
function(a){if(e(this).closest(".playlistItem").hasClass("playlist_locked"))return!1});if(ad)h.find("a[class=premove]").off().on("click",function(a){a.preventDefault();a=e(this).closest(".playlistItem");var b=parseInt(a.attr("data-id"),10);if(a.hasClass("playlist_locked"))return!1;C.removeTrack(b)})}function Lc(a,b,c){"local"==a||"folder"==a?(c.indexOf("\\")&&(c=c.replace(/\\/g,"/")),c.match(/^http([s]?):\/\/.*/)||(a=window.location.href,a=a.substr(0,a.lastIndexOf("/")+1),/^\.\.\//i.test(c)&&(c=c.substr(3),
"/"==a.charAt(a.length-1)&&(a=a.substr(0,a.lastIndexOf("/"))),a=a.substr(0,a.lastIndexOf("/")+1)),c=a+c),isMobile||(b=0<c.lastIndexOf("/")?c.substr(c.lastIndexOf("/")+1):c)):"soundcloud"==a&&(c=c.replace(/\/stream\\?/,"/download").replace(/\.mp3/,""));b=b.replace(/[^A-Z0-9\-\_\.]+/ig,"_");/\.(mp3)$/i.test(b)||(b+=".mp3");return{name:b,path:c}}function Mc(a,b){if(isMobile)if(ta=!0,Nd)ed||(tc=fd())&&(ed=!0),tc?gd(tc,a,b):ta=!1;else{var c=fd();c?gd(c,a,b):ta=!1}else Od.attr("src",hap_source_path+"dl.php?path="+
b+"&name="+a)}function gd(a,b,c){e.ajax({type:"POST",url:hap_source_path+"mail.php",data:"mail="+a+"&name="+b+"&path="+c}).done(function(a){ta=!1}).fail(function(a,b,c){t&&alert("Send email error: "+a.responseText);hd();ta=!1});Tb.css({marginTop:-Tb.height()/2+"px",display:"block"}).stop().animate({opacity:1},{duration:500});Db&&clearTimeout(Db);Db=setTimeout(hd,Pd)}function hd(){Db&&clearTimeout(Db);Tb.stop().animate({opacity:0},{duration:500,complete:function(){Tb.css("display","none")}})}function fd(){for(var a=
prompt("Please enter your email address where download link will be sent:"),b=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;(!b.test(a)||D(a))&&null!=a;)a=prompt("Please enter a valid email address:");return a}function Qb(a){if(D(uc))return alert("soundcloudApiKey has not been set! Skipping Soundcloud url."),y.shift(),K(),!1;/\/favorites$/.test(a)&&(a=a.replace(/\/favorites$/,"/likes"));var b=Qd(a,uc);e.ajax({url:b,dataType:"jsonp",cache:!1}).done(function(b){var c,d;if(b.tracks){c=b.tracks.length;c>X&&(c=
X);for(d=0;d<c;d++)b.tracks[d].streamable&&b.tracks[d].stream_url?r.push(vc(b.tracks[d])):(c+=1,c>b.tracks.length&&(c=b.tracks.length));r.length>X&&(r=r.slice(0,X));Ia()}else if(b.duration)b.permalink_url=a,b.streamable&&b.stream_url&&r.push(vc(b)),r.length>X&&(r=r.slice(0,X)),Ia();else if(b.username)/likes/.test(a)?(console.log("DATA.USERNAME.LIKES"),bb=b.uri+"/likes"):bb=/favorites/.test(a)?b.uri+"/favorites":b.uri+"/tracks",Qb(bb);else if(e.isArray(b)){c=b.length;c>X&&(c=X);for(d=0;d<c;d++)b[d].streamable&&
b[d].stream_url?r.push(vc(b[d])):(c+=1,c>b.length&&(c=b.length));50==c?(Pb+=50,Pb<X?Qb(bb):(r.length>X&&(r=r.slice(0,X)),Ia())):(r.length>X&&(r=r.slice(0,X)),Ia())}else b.kind&&"group"==b.kind?(bb=b.uri+"/tracks",Qb(bb)):(y.shift(),K())}).fail(function(b,f,d){t&&alert("Playlist process failed, soundcloud: "+a);y.shift();K()})}function vc(a){var b={type:"soundcloud"};a.duration&&(b.length=a.duration);b.mp3=a.stream_url+(/\?/.test(a.stream_url)?"&":"?")+"consumer_key="+uc;b.title=a.title;oa&&(b.url=
oa);a.downloadable&&a.download_url?(N&&(b.dlink=N),T&&(b.download=T)):(N&&1!=N&&"true"!=N&&(b.dlink=N),T&&1!=T&&"true"!=T&&(b.download=T));a.artwork_url?b.thumb=a.artwork_url:S&&(b.thumb=S);return b}function Qd(a,b){return(/api\./.test(a)?a+"?":"http://api.soundcloud.com/resolve?url="+a+"&")+"format=json&offset="+Pb+"&consumer_key="+b+"&callback=?"}function Xc(){var a=r[Aa].mp3+"?rand="+99999999*Math.random();ID3.loadTags(a,function(){var b=ID3.getAllTags(a);b.title&&(r[Aa].title=b.title);b.artist&&
(r[Aa].artist=b.artist);b.album&&(r[Aa].album=b.album);if(b=b.picture){var c="",f=0,d=b.data.length;for(f;f<d;f++)c+=String.fromCharCode(b.data[f]);r[Aa].thumb="data:"+b.format+";base64,"+window.btoa(c)}Aa++;Aa<r.length?Xc():Ia()},{tags:["title","artist","album","picture"],onError:function(a){}})}function Rd(){var a=m.currentTime,b=m.duration;void 0!=m.buffered&&0!=m.buffered.length&&z(b)&&(Ka=m.buffered.end(0)/b);z(a)&&z(b)&&(La&&La.html(Gc(a)+Ub),Ma&&Ma.html(Ic(b)));if(ha)ia&&(z(Ka)&&(c=Ka,Ba.beginPath(),
Ba.arc(M/2,R/2,bc-ob/2,-Kb,Jc*c-Kb,!1),Ba.strokeStyle=Sd,Ba.lineCap="butt",Ba.lineWidth=ob,Ba.stroke()),z(a)&&z(b)&&(ja=a/b,!ea&&B&&Ua(a/b)));else{if(z(Ka)){var c=Ka*V;c>V&&(c=V);cb&&cb.width(c)}z(a)&&z(b)&&!ea&&Ea&&Ea.width(a/b*V)}}function wc(){id||(yb=e(document.createElement("audio")).attr("preload",Td),m=yb[0],id=!0);Vb&&(m.src=db);Z&&(m.load(),m.play());yb.on("ended",function(a){"undefined"!==typeof audioPlayerSoundEnd&&audioPlayerSoundEnd(C,J,n.getCounter());na();n.advanceHandler(1,!0)}).on("pause",
function(a){"undefined"!==typeof audioPlayerSoundPause&&audioPlayerSoundPause(C,J,n.getCounter())}).on("play",function(a){hc||("undefined"!==typeof audioPlayerSoundStart&&audioPlayerSoundStart(C,J,n.getCounter()),hc=!0);"undefined"!==typeof audioPlayerSoundPlay&&audioPlayerSoundPlay(C,J,n.getCounter());ha&&ia&&Va()}).on("canplay",function(a){}).on("canplaythrough",function(a){}).on("loadedmetadata",function(a){m.volume=w;nb&&(m.seekable&&0<m.seekable.length&&(m.currentTime=nb*m.duration),nb=null);
va&&clearInterval(va);va=setInterval(Rd,250)}).on("error",function(a){switch(m.error.code){case m.error.MEDIA_ERR_ABORTED:console.log("You aborted the audio playback.");break;case m.error.MEDIA_ERR_NETWORK:console.log("A network error caused the audio download to fail part-way.");break;case m.error.MEDIA_ERR_DECODE:console.log("The audio playback was aborted due to a corruption problem or because the audio used features your browser did not support.");break;case m.error.MEDIA_ERR_SRC_NOT_SUPPORTED:console.log("The audio could not be loaded, either because the server or network failed or because the format is not supported.");
break;default:console.log("An unknown error occurred.")}});Z?(B=!0,qb("off")):(B=!1,sa("off"));Z=U=!0}function dd(){if(!ha&&(V=Ib.width(),z(Ka)&&cb&&cb.width(Ka*V),!ea&&Ea)){var a,b;m&&(a=m.currentTime,b=m.duration);try{a&&z(a)&&b&&z(b)&&Ea.width(a/b*V)}catch(c){}}cd&&!W&&dc();eb&&Y&&Y.checkSize()}function jc(){jd.css("display","none")}function Tc(){jd.css("display","block")}function Pc(){va&&clearInterval(va);eb&&Y&&Y.deactivate();Na.html(Eb);La.html(xc+Ub);Ma.html(yc);ha?ia&&(ja=0,A.clearRect(0,
0,M,R),Ba.clearRect(0,0,M,R)):(Ea.width(0),cb.width(0));sa("off");Ga.css("display","none")}function gc(){va&&clearInterval(va);Ja||(eb&&Y&&Y.deactivate(),Na.html(Eb));La.html(xc+Ub);Ma.html(yc);ha?ia&&(ja=0,A.clearRect(0,0,M,R),Ba.clearRect(0,0,M,R)):(Ea.width(0),cb.width(0));sa("off");Ga.css("display","none")}function sa(a){"on"==a?h.find(".controls_toggle").find("img").attr("src",Ud):h.find(".controls_toggle").find("img").attr("src",Vd);da&&da.hasClass("play_link")&&da.attr("src",Wb);ha&&ia&&(A.clearRect(0,
0,M,R),Ua(ja),Va())}function qb(a){"on"==a?h.find(".controls_toggle").find("img").attr("src",Wd):h.find(".controls_toggle").find("img").attr("src",Xd);da&&da.hasClass("play_link")&&kd.hasClass("hap_text_link")&&da.attr("src",ld);ha&&ia&&(A.clearRect(0,0,M,R),Ua(ja),Va())}function z(a){return!isNaN(parseFloat(a))&&isFinite(a)}function Gc(a){a=Math.round(a);minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function Ic(a){a=Math.round(a);
minutes=Math.floor(a/60);minutes=10<=minutes?minutes:"0"+minutes;a=Math.floor(a%60);return minutes+":"+(10<=a?a:"0"+a)}function xa(a){if("string"===typeof a){if(pc&&n&&-1!=n.getCounter()){var b=n.getCounter();a=qc(v[b].id)+rc+a}}else{if("number"===typeof a){if(!n||0>a||a>x-1)return!1}else if(!n)return!1;b=n.getCounter();a=ec(b)}eb&&Y?(Y.input(a),Y.activate()):Na&&Na.html(a)}function ec(a,b){if("undefined"===typeof b||null===b)b=!0;return v[a]&&v[a].title&&!D(v[a].title)?b?pc?qc(v[a].id)+rc+v[a].title:
v[a].title:v[a].title:Eb}function qc(a){return 9>a?"0"+(a+1):a+1}function Yd(a){var b=[],c=[],f=0;for(f;f<a;f++)b[f]=f;var f=0,d;for(f;f<a;f++)d=Math.round(Math.random()*(b.length-1)),c[f]=b[d],b.splice(d,1);return c}function Zd(a){var b=[],c=0;for(c;c<a;c++)b[c]=c;return b}function Jd(a,b,c){"title"==b?a.sort(function(a,b){return a.title==b.title?0:a.title<b.title?-1:1}):"type"==b&&a.sort(function(a,b){return a.type==b.type?0:a.type<b.type?-1:1});c&&a.reverse()}function D(a){return a?0==a.replace(/^\s+|\s+$/g,
"").length:!0}function Id(a){a=a.split(":");for(var b=0,c=1;0<a.length;)b+=c*parseInt(a.pop()),c*=60;return b}function Hd(a){if(window.ActiveXObject&&window.GetObject){var b=new ActiveXObject("Microsoft.XMLDOM");b.loadXML(a);return b}if(window.DOMParser)return(new DOMParser).parseFromString(a,"text/xml");throw Error("No XML parser available");}function $d(a,b){return b-a}function Dd(a){if("string"===typeof a)switch(a.toLowerCase()){case "true":case "yes":case "1":return!0;case "false":case "no":case "0":case null:return!1;
default:return!!a}else if("boolean"===typeof a)return!!a}function ae(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}function Yc(a){var b,c="",f,d="",g="",h,k,m,l;b=a.type.toLowerCase();a.origtype&&(c=a.origtype.toLowerCase());a.mp3?f=a.mp3:a.path&&(f=a.path);a.title&&(d=a.title);a.thumb&&(g=a.thumb);a.download&&(h=1==a.download?f:a.download);a.url&&(m=a.url);a.dlink&&(k=1==a.dlink?f:a.dlink);"local"==b?"title"==wa?l="<li class= 'playlistItem' data-type='local' data-origtype='"+
c+"' data-mp3='"+f+"' data-thumb='"+g+"' data-title='"+d+"'><a class='playlistNonSelected' href='#'>"+d+"</a></li>":"thumb"==wa?l="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+f+"' data-thumb='"+g+"' data-title='"+d+"'><a class='playlistNonSelected' href='#'><img src='"+g+"' alt='thumb'/></a></li>":"all"==wa&&(l="<li class= 'playlistItem' data-type='local' data-origtype='"+c+"' data-mp3='"+f+"' data-thumb='"+g+"' data-title='"+d+"'><a class='playlistNonSelected' href='#'><span class='hap_thumb'><img src='"+
g+"' alt='thumb'/></span><span class='hap_title'><p>'"+d+"'</p></span></a></li>"):(l="<li class= 'playlistItem' data-type='"+b+"' data-path='"+f+"' data-thumb='"+g+"'></li>","database_data"==b&&(f=a.table?a.table:null,c=a.limit?a.limit:null,a=a.range?a.range:null,f&&(f=' data-table="'+f+'" ',d=l.match(/\>/),l=l.slice(0,d.index)+f+l.slice(d.index)),c&&(f=' data-limit="'+c+'" ',d=l.match(/\>/),l=l.slice(0,d.index)+f+l.slice(d.index)),a&&(f=' data-range="'+a+'" ',d=l.match(/\>/),l=l.slice(0,d.index)+
f+l.slice(d.index))));h&&(f=' data-download="'+h+'" ',d=l.match(/\>/),l=l.slice(0,d.index)+f+l.slice(d.index));"local"==b?(k&&(f="<a class='dlink' href='#' data-dlink='"+k+"'><img src='"+sc+"' alt='download'/></a>",d=l.match(/\<\/a\>\<\/li\>/),l=l.slice(0,d.index)+f+l.slice(d.index)),m&&(f="<a class='plink' href='"+m+"' target='_blank'><img src='"+$c+"' alt='purchase'/></a>",d=l.match(/\<\/a\>\<\/li\>/),l=l.slice(0,d.index)+f+l.slice(d.index))):(k&&(f=' data-dlink="'+k+'" ',d=l.match(/\>/),l=l.slice(0,
d.index)+f+l.slice(d.index)),m&&(f=' data-plink="'+m+'" ',d=l.match(/\>/),l=l.slice(0,d.index)+f+l.slice(d.index)));b=document.createElement("ul");b.innerHTML=l;return e(b.firstChild)}function nc(a){a=e(a);var b;a=e("<div>").append(a.clone()).html();b=document.createElement("ul");b.innerHTML=a;return e(b.firstChild)}function fb(a){x=v.length;if(0<x){Rb();var b=n.getCounter();a==b?(Oc(),n.setPlaylistItems(x)):(n.setPlaylistItems(x,!1),a<b&&n.reSetCounter(n.getCounter()-1));Ja&&xa()}else ub(),Za=null,
"undefined"!==typeof playlistEmpty&&playlistEmpty(C,J)}var l=!1,C=this;e("body");var bd=e(window),pa=e(document);e.inArray(window.location.protocol,["http:","https:"]);var zc,Lb="download"in document.createElement("a"),gb=navigator.userAgent,Xb;if(-1<gb.indexOf("iPhone")||-1<gb.indexOf("iPod")||-1<gb.indexOf("iPad"))-1<gb.indexOf("iPhone")?Xb="iPhone":-1<gb.indexOf("iPod")?Xb="iPod":-1<gb.indexOf("iPad")&&(Xb="iPad");var qd=-1<navigator.userAgent.toLowerCase().indexOf("safari/"),Ac=document.createElement("audio"),
Vb,md=!1;Ac.canPlayType&&(md=!0,Vb=!!Ac.canPlayType&&""!=Ac.canPlayType("audio/mpeg"));var Ad=hap_source_path+k.buttonsUrl.prev,ud=hap_source_path+k.buttonsUrl.prevOn,Bd=hap_source_path+k.buttonsUrl.next,vd=hap_source_path+k.buttonsUrl.nextOn,Vd=hap_source_path+k.buttonsUrl.play,Ud=hap_source_path+k.buttonsUrl.playOn,Xd=hap_source_path+k.buttonsUrl.pause,Wd=hap_source_path+k.buttonsUrl.pauseOn,Nb=hap_source_path+k.buttonsUrl.loop,rb=hap_source_path+k.buttonsUrl.loopOn,Bc=hap_source_path+k.buttonsUrl.volume,
wd=hap_source_path+k.buttonsUrl.volumeOn,Cc=hap_source_path+k.buttonsUrl.mute,xd=hap_source_path+k.buttonsUrl.muteOn,Ob=hap_source_path+k.buttonsUrl.shuffle,sb=hap_source_path+k.buttonsUrl.shuffleOn,Cd=hap_source_path+k.buttonsUrl.download,yd=hap_source_path+k.buttonsUrl.downloadOn,$c=hap_source_path+k.buttonsUrl.trackUrlIcon,sc=hap_source_path+k.buttonsUrl.trackDownloadIcon,Kd=hap_source_path+k.buttonsUrl.trackRemoveIcon,ld=hap_source_path+k.buttonsUrl.link_pause,Wb=hap_source_path+k.buttonsUrl.link_play,
h=e(this).css("display","block"),ha=h.hasClass("hap_circle"),ia=!1;md&&ae()&&(ia=!0);var Uc="html5audio-popup"==h.attr("id"),Wa=h.find(".playlistHolder"),ma=h.find(".playlist_inner").css("opacity",0);h.find(".playerHolder");h.find(".player_mediaTime");var La=h.find(".player_mediaTime_current"),Ma=h.find(".player_mediaTime_total"),od=h.find(".player_mediaName_Mask"),Na=h.find(".player_mediaName");h.find(".player_controls");var be=h.find(".player_volume"),jd=h.find(".preloader"),Ga=h.find(".player_download");
h.find(".componentPlaylist");var za=e(k.playlistList);Uc&&window.opener&&(za=window.opener.jQuery(k.playlistList));var J=k.sound_id,Z=k.autoPlay,Td=k.autoLoad;isMobile&&(Z=!1,k.autoPlay=!1);var uc=k.soundcloudApiKey,X=k.soundcloud_result_limit,mc=k.podcast_result_limit,eb=k.useSongNameScroll,Ja=k.autoSetSongTitle,aa=k.loopingOn,ba=k.randomPlay,Ub=k.mediaTimeSeparator,Hc=k.seekTooltipSeparator,Eb=k.defaultArtistData,pc=k.useNumbersInPlaylist,rc=k.titleSeparator,Za=k.activePlaylist,t=k.useAlertMessaging,
cd=k.activatePlaylistScroll,pb=k.playlistScrollOrientation.toLowerCase(),Md=k.sortablePlaylistItems,Nd=k.autoReuseMailForDownload,ad=k.useRemoveBtnInTracks,ce=k.useVolumeTooltip,de=k.useSeekbarTooltip,wa=k.playlistItemContent.toLowerCase(),ee=k.useKeyboardNavigation,fe=k.useBtnRollovers,Qc=k.usePlaylistRollovers,Wc=k.getTrackInfoFromID3;La.html("0:00");Ma.html("0:00");var xc=La.html(),yc=Ma.html();Na.html(Eb);La.html(xc+Ub);Ma.html(yc);var Aa,Ha,ca,xb,Ya,Xa,W=!1,lc,oa,ed,tc,ta,N,T,wb,S,Ab,kd,da,zb,
ic,oc=!1;void 0!=Wa.attr("data-playlistLocked")&&(oc=!0);var vb=!1,Cb,u,p=null,q=!0,Dc=!1,hc=!1,bb,Pb,Mb,U=!1,db="",B=!1,Gd=hap_source_path+"includes/ba-simple-proxy.php",va,Ka;aa&&h.find(".player_loop").find("img").attr("src",rb);ba&&h.find(".player_shuffle").find("img").attr("src",sb);var v=[],ua=[],E=[],x=0,I,Sc,Vc=e('<div class="hap_feedParser"/>'),Od=0==h.find("iframe[id='dl_iframe']").length?e('<iframe id="dl_iframe"/>').css({position:"absolute",left:"-10000px",display:"none"}).appendTo(h):
h.find("iframe[id='dl_iframe']"),$a=e("<div/>"),kc=e("<div/>");if(isMobile)var Db,Pd=1E3,Tb=0==Wa.find("div[id='download_confirm']").length?e('<div id="download_confirm"><p>DOWNLOAD STARTING</p></DIV>').css({opacity:0,zIndex:1E3}).appendTo(Wa):Wa.find("div[id='download_confirm']");var r=[],y=[],id=!1,yb,m,Y;eb&&g();var n=e.playlistManager({randomPlay:ba,loopingOn:aa});e(n).on("ap_PlaylistManager.COUNTER_READY",function(){var a=n.getCounter(),b=v[a];b&&!oc&&(Nc(),Ja&&xa(),Mb=b.origtype?b.origtype:
b.type,db=b.mp3,b.download?wb=!0:wb=null,Lb&&wb&&(Ga.find("a.hap-download").length?Ga.find("a.hap-download").attr("href",b.download):(b=e('<a class="hap-download" href="'+b.download+'" download></a>'),Ga.off("click").wrapInner(b))),tb(),wc(),"undefined"!==typeof itemTriggered&&itemTriggered(C,J,a))});e(n).on("ap_PlaylistManager.PLAYLIST_END",function(){Nc();"undefined"!==typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(C,J);B=!1;sa("off")});e(n).on("ap_PlaylistManager.PLAYLIST_END_ALERT",function(){"undefined"!==
typeof audioPlayerPlaylistEnd&&audioPlayerPlaylistEnd(C,J)});var ab="",Oa="",Pa="",Sb;"ontouchstart"in window?(Sb=!0,ab="touchstart.ap mousedown.ap",Oa="touchmove.ap mousemove.ap",Pa="touchend.ap mouseup.ap"):(Sb=!1,ab="mousedown.ap",Oa="mousemove.ap",Pa="mouseup.ap");var lb=!1,Yb,Fb=!1,w=k.defaultVolume;0>w&&(w=0);0==w?Yb=.5:1<w&&(w=1);var O=h.find(".volume_seekbar").css("cursor","pointer").on(ab,function(a){a.preventDefault();Ca(a);return Fb=!1}),kb="horizontal";void 0!=O.attr("data-orientation")&&
(kb=O.attr("data-orientation").toLowerCase());if(void 0!=O.attr("data-autoHide")){var lb=!0,ib=!1,G,Hb=parseInt(O.attr("data-autoHide"),10);if(!isMobile)be.on("mouseover",function(){if(!l)return!1;G&&clearTimeout(G);O.css("display","block");ib=!0;return!1}).on("mouseout",function(){if(!l)return!1;G&&clearTimeout(G);G=setTimeout(F,Hb);return!1})}var jb=!1,P=0,Gb=h.find(".volume_level"),Qa=h.find(".volume_bg");if(ce&&!isMobile){O.on("mouseover",qa);var ga=h.find(".player_volume_tooltip"),pd=parseInt(ga.css("top"),
10);ga.on("mouseenter",function(){O.off("mouseover",qa);ga.css("display","none")}).on("mouseleave",function(){O.on("mouseover",qa)})}else h.find(".player_volume_tooltip").remove();var Da,nb,ea=!1,Ib=h.find(".progress_bg"),cb=h.find(".load_progress"),Ea=h.find(".play_progress"),ya=h.find(".player_progress"),V=Ib.width();if(ha){var hb=h.find(".load_canvas").css("cursor","pointer"),nd=h.find(".play_canvas"),ka=h.find(".circlePlayer");parseFloat(ka.attr("data-offOpacity"),10);parseFloat(ka.attr("data-onOpacity"),
10);var ge=parseInt(ka.attr("data-strokeSize"),10),he=nd.attr("data-bgcolor"),ie=hb.attr("data-bgcolor");parseInt(ka.attr("data-tolerance"),10);var je=hb.width(),ke=hb.height();if(ia){var ob=ge,cc=he,Sd=ie,A=hb[0].getContext("2d"),Ba=nd[0].getContext("2d"),Jc=2*Math.PI,Kb=Math.PI/2,M=je,R=ke,bc=M/2,ac=bc-ob,Ec=k.tolerance,$b,Jb=!1,ja=0;hb.on(ab,function(a){a.preventDefault();Zb(a)?(Jb=!1,$b>ac-Ec||ea||(mb(!0),A.clearRect(0,0,M,R),Ua(ja),Va())):(Jb=!0,Sa(a));return!1});ya=hb}}else ya=h.find(".player_progress").css("cursor",
"pointer").on(ab,function(a){Sa(a);return!1});if(de&&!isMobile){ya.on("mouseover",ra);var la=h.find(".player_progress_tooltip").css("zIndex",50);la.find("p").html("0:00"+Hc+"0:00");la.on("mouseenter",function(){ya.off("mouseover",ra);la.css("display","none")}).on("mouseleave",function(){ya.on("mouseover",ra)})}else h.find(".player_progress_tooltip").remove();ee&&pa.keyup(function(a){if(!l||q)return!1;a||(a=window.event);a.cancelBubble?a.cancelBubble=!0:a.stopPropagation&&a.stopPropagation();a=a.keyCode;
37==a?C.previousAudio():39==a?C.nextAudio():32==a?C.toggleAudio():77==a&&(H(),fa());return!1});bd.resize(function(){if(!l||q)return!1;zc&&clearTimeout(zc);zc=setTimeout(dd,150)});this.getCurrentTime=function(){if(!l||!Mb)return!1;var a;m&&(a=m.currentTime);return a};this.setPlayIcon=function(){da&&da.hasClass("play_link")&&da.attr("src",Wb);B=!1};this.playAudio=function(){if(!l||q||!p||B||!U)return!1;m&&m.play();qb("off");U=B=!0};this.pauseAudio=function(){if(!l||q||!p||!B||!U)return!1;m&&m.pause();
sa("off");B=!1};this.toggleAudio=function(){if(!l||q||!p||!U)return!1;mb()};this.stopAudio=function(){if(!l||q||!p||!U)return!1;m&&(m.src="",Vb&&(m.src=db));gc();B=!1};this.checkAudio=function(a){if(!l||q||!p)return!1;a=a.toLowerCase();B&&("pause"==a?m&&m.pause():"stop"==a&&(m&&(m.src="",Vb&&(m.src=db)),gc()),B=!1,sa("off"))};this.nextAudio=function(){if(!l||q||!p)return!1;na();n.advanceHandler(1,!0)};this.previousAudio=function(){if(!l||q||!p)return!1;na();n.advanceHandler(-1,!0)};this.loadAudio=
function(a){if(!l||q||!p)return!1;if("string"===typeof a){var b=0,c=!1;for(b;b<x;b++)if(a==v[b].title){a=b;c=!0;break}if(!c)return t&&alert('Track with name "'+a+'" doesnt exist. Load audio failed.'),!1}else if("number"===typeof a){if(0>a||a>x-1)return t&&alert('Invalid track number. Track number  "'+a+'" doesnt exist. Load audio failed.'),!1}else return t&&alert("Load audio method requires either a track number or a track title to load. Load audio failed."),!1;na();n.processPlaylistRequest(a)};this.loadPlaylist=
function(a){if(!l||q)return!1;if("undefined"===typeof a)return t&&alert("loadPlaylist method requires data parameter. loadPlaylist failed."),!1;Za=a;Rc(Za)};this.addTrack=function(a,b,c,f){if(!l||q)return!1;if("undefined"===typeof a)return t&&alert("addTrack method requires type parameter. AddTrack failed."),!1;if("undefined"===typeof b)return t&&alert("addTrack method requires format parameter. AddTrack failed."),!1;if("undefined"===typeof c)return t&&alert("addTrack method requires track parameter. AddTrack failed."),
!1;var d=1,g=!1;if("string"!==typeof c&&"[object Object]"!==Object.prototype.toString.call(c))if("[object Array]"===Object.prototype.toString.call(c))d=c.length,g=!0;else return t&&alert("addTrack method requires track as string, object or array parameter. AddTrack failed."),!1;ca=f;a=a.toLowerCase();"visible"==a?(p&&W&&ub(),xb=!0,W=!1):(p&&!W&&ub(),W=Ya=!0);Ha=!1;if(p)if("undefined"!==typeof ca){if(0>ca||ca>x)return t&&alert('Invalid position to insert track to. Position number "'+f+'" doesnt exist. AddTrack failed.'),
!1;ca==x&&(Ha=!0)}else Ha=!0,ca=x;else{if("undefined"!==typeof ca){if(0!=ca)return t&&alert('Invalid position to insert track to. Position number "'+f+'" doesnt exist. AddTrack failed.'),!1}else ca=0;Ha=!0}Tc();q=!0;vb=!1;f=0;var h,k=e("<ul id = playlist"+Math.floor(9999*Math.random())+"></ul>");b=b.toLowerCase();for(f;f<d;f++)h=g?c[f]:c,"html"==b?nc(h).appendTo(k):(h.type&&h.mp3||h.path)&&Yc(h).appendTo(k);y=[];$a.empty();k.appendTo($a).find("li[class='playlistItem']").each(function(){y.push(e(this))});
Xa=!1;p||(Xa=!0,p="visible"==a?ma:kc);K()};this.inputAudio=function(a){if(!l||q)return!1;if("undefined"===typeof a)return t&&alert("inputAudio method requires data parameter. inputAudio failed."),!1;if("undefined"===a.mp3)return t&&alert("inputAudio method requires data.mp3 parameter. inputAudio failed."),!1;na();n.reSetCounter();db=a.mp3;"undefined"!==a.title?xa(a.title):xa(Eb);isMobile&&(Z=!0);tb();wc()};this.removeTrack=function(a){if(!l||q||!p)return!1;if("undefined"===typeof a)return t&&alert("removeTrack method requires track parameter. removeTrack failed."),
!1;if("string"===typeof a){var b=0,c=!1;for(b;b<x;b++)if(a==v[b].title){a=b;c=!0;break}if(!c)return t&&alert('Track with name "'+a+'" doesnt exist. RemoveTrack failed.'),!1;E[a]&&v[a]?(E[a].remove(),v.splice(a,1),fb(a)):t&&alert('RemoveTrack with name "'+a+'" failed.')}else if("number"===typeof a){if(0>a||a>x-1)return t&&alert('Invalid track number. Track number  "'+a+'" doesnt exist. RemoveTrack failed.'),!1;E[a]&&v[a]?(E[a].remove(),v.splice(a,1),fb(a)):t&&alert('RemoveTrack with name "'+a+'" failed.')}else if("[object Array]"===
Object.prototype.toString.call(a))if("string"===typeof a[0]?b=!0:"number"===typeof a[0]&&(b=!1),b){var b=0,c=a.length,f,d,g;b;a:for(;b<c;b++)if(d=a[b],"string"===typeof d){g=0;f=v.length;if(0==f){fb();break a}for(g;g<f;g++)if(d==v[g].title&&E[g]&&v[g]){E[g].remove();v.splice(g,1);fb(g);break}}}else a:for(a.sort($d),b=0,c=a.length,b;b<c;b++){if(d=a[b],"number"===typeof d){f=v.length;if(0==f){fb();break a}-1<d&&d<f&&E[d]&&v[d]&&(E[d].remove(),v.splice(d,1),fb(d))}}else return t&&alert("removeTrack method requires track parameter as string, number or array. removeTrack failed."),
!1};this.destroyAudio=function(){if(!l||q||!p)return!1;Oc()};this.destroyPlaylist=function(){if(!l||q||!p)return!1;ub()};this.setTitle=function(a){if(!l||q||!p)return!1;xa(a)};this.toggleShuffle=function(){if(!l||q)return!1;ba?(h.find(".player_shuffle").find("img").attr("src",Ob),ba=!1):(h.find(".player_shuffle").find("img").attr("src",sb),ba=!0);n.setRandom(ba)};this.toggleLoop=function(){if(!l||q)return!1;aa?(h.find(".player_loop").find("img").attr("src",Nb),aa=!1):(h.find(".player_loop").find("img").attr("src",
rb),aa=!0);n.setLooping(aa)};this.setVolume=function(a){if(!l||q)return!1;0>a?a=0:1<a&&(a=1);w=a;fa()};this.getVolume=function(){return l?w:!1};this.setAutoPlay=function(a){if(!l)return!1;Z=a};this.getAutoPlay=function(){return l?Z:!1};this.getIsMobile=function(){return isMobile};this.getMobileType=function(){return Xb};this.getSetupDone=function(){return l};this.getPlaylistLoaded=function(){return vb};this.getPlaylistTransition=function(){return q};this.getMediaPlaying=function(){return!l||q?!1:
B};this.getAudioInited=function(){return!l||q?!1:U};this.getMediaType=function(){return!l||q?!1:Mb};this.getActiveItem=function(){return!l||q?!1:n.getCounter()};this.getPlaylistItems=function(a){if(!l||q||!E||0==E.length)return!1;if("string"===typeof a)return E;if("number"===typeof a)return 0>num||num>x-1||!E[num]?!1:E[num]};this.getMediaCount=function(){return!l||q?!1:z(x)?x:0};this.getPlaylistHidden=function(){return!l||q?!1:W};this.get_hidden_playlist_holder=function(){return l?kc:!1};this.getPlaylistList=
function(){return l&&za&&0!=za.length?za:!1};this.orderPlaylist=function(a,b){if(!l||!p)return!1;if("undefined"===typeof a)return t&&alert("orderPlaylist method requires action parameter. orderPlaylist failed."),!1;var c=p.children("li"),f=c.length;if(0==f)return!1;var d=a.toLowerCase();if("reverse"==d)p.append(c.get().reverse());else if("random"==d||"remap"==d||"swap"==d){if("random"==d)b=Yd(f);else if("remap"==d){if("undefined"===typeof b||b.length!=f)return!1}else if("swap"==d){if("undefined"===
typeof b||2!=b.length)return!1;c=Zd(f);c.splice(b[1],1,b[0]);c.splice(b[0],1,b[1]);b=e.extend(!0,[],c)}else return!1;orderedItems=jQuery.map(b,function(a){return jQuery(E).get(a)});p.empty().html(orderedItems)}else return t&&alert("Wrong action parameter for orderPlaylist method. orderPlaylist failed."),!1;Rb();if(c=ma.find("a[class=playlistSelected]").attr("data-id"))n.reSetCounter(c),Ja&&xa()};this.checkScroll=function(){if(!l||q||!p)return!1;dc()};this.reinitScroll=function(){if(!l||q||!p)return!1;
I&&(I.reinitialise(),"vertical"==pb?(I.scrollToY(0),e(".jspPane").css("top","0px")):(I.scrollToX(0),e(".jspPane").css("left","0px")));eb&&Y&&n&&-1!=n.getCounter()&&Ja&&xa()};this.getPlaylistData=function(){return l&&!q&&p?v:!1};this.getSoundId=function(){return l?J:!1};this.getTouch=function(){return l?Sb:!1};this.get_hap_source_path=function(){return l?hap_source_path:!1};(function(){var a=[h.find(".controls_next"),h.find(".controls_prev"),h.find(".controls_toggle"),h.find(".player_volume"),h.find(".player_download"),
h.find(".player_loop"),h.find(".player_shuffle")],b,c=a.length,f=0;for(f;f<c;f++)if(b=e(a[f]).css("cursor","pointer").on("click",sd),fe&&!isMobile)b.on("mouseover",td).on("mouseout",zd)})();(function(){e(".hap_text_link").each(function(){var a=e(this),b=a.attr("href");"undefined"!==typeof b&&!1!==b&&-1<b.toLowerCase().indexOf(".mp3")&&a.prepend('<img class="play_link" src="'+Wb+'"/>')});e(".hap_text_link, .hap_image_link").click(function(a){if(!l||q)return!1;a=e(this);var b=a.attr("href");if("undefined"===
typeof b||!1===b)return!1;if(zb&&zb==b)return mb();na();n.reSetCounter();zb=b;kd=a;ic=!0;da&&da.attr("src",Wb);a.hasClass("hap_text_link")&&(da=a.find("img").attr("src",ld));db=zb;Z=!0;tb();wc();return ic=!1})})();Za?Rc(Za):l||Zc();return this}})(jQuery);
(function(e){function k(g){this._loopingOn=g.loopingOn;this._randomPlay=g.randomPlay;this._playlistItems;this._lastInOrder=!1;this._counter=-1;this._lastPlayedFromPlaylistClick;this._lastRandomCounter;this._randomPaused=!1;this._randomArr=[];this._playlistSelect=!1}e.playlistManager=function(g){return new k(g)};k.prototype={setCounter:function(g,e){"undefined"===typeof e&&(e=!0);this._counter=e?this._counter+parseInt(g,10):parseInt(g,10);this._checkCounter()},getCounter:function(){return this._randomPlay?
this._playlistSelect?this._counter:this._randomArr[this._counter]:this._counter},advanceHandler:function(g){this._playlistSelect=!1;this._randomPaused?this._handleRandomPaused(g):this.setCounter(g)},processPlaylistRequest:function(g){this._playlistSelect=!1;this._randomPlay&&(this._playlistSelect=!0,this._lastPlayedFromPlaylistClick=g,this._randomPaused||(this._lastRandomCounter=this._counter,this._randomPaused=!0));this.setCounter(g,!1)},getLastInOrder:function(){return this._lastInOrder},getRandomPaused:function(){return this._randomPaused},
setPlaylistItems:function(g,e){"undefined"===typeof e&&(e=!0);e&&(this._counter=-1);this._playlistItems=g;this._randomPlay&&this._makeRandomList()},reSetCounter:function(g){"undefined"===typeof g?this._counter=-1:(g=parseInt(g,10),this._playlistItems?(g>this._playlistItems-1?g=this._playlistItems-1:0>g&&(g=0),this._counter=g):this._counter=-1)},setRandom:function(g){(this._randomPlay=g)&&this._makeRandomList();this._randomChange()},setLooping:function(g){this._loopingOn=g},_handleRandomPaused:function(g){var k=
e(this);this._randomPaused=!1;this._lastRandomCounter+g>this._playlistItems-1?(this._counter=this._playlistItems-1,k.trigger("ap_PlaylistManager.COUNTER_READY")):0>this._lastRandomCounter+g?(this._counter=0,k.trigger("ap_PlaylistManager.COUNTER_READY")):this.setCounter(this._lastRandomCounter+g,!1)},_randomChange:function(){this._randomPlay?(this._activeIndexFirst(),this._counter=0):this._randomPaused?(this._counter=this._lastPlayedFromPlaylistClick,this._randomPaused=!1):this._counter=this._randomArr[this._counter]},
_checkCounter:function(){if(isNaN(this._counter))alert("ap_PlaylistManager message: No active media, counter = "+this._counter);else{var g=e(this);this._lastInOrder=!1;this._loopingOn?(this._randomPlay?this._counter>this._playlistItems-1?(this._counter=this._randomArr[this._playlistItems-1],this._makeRandomList(),this._firstIndexCheck(),this._counter=0,g.trigger("ap_PlaylistManager.PLAYLIST_END")):0>this._counter&&(this._counter=this._randomArr[0],this._makeRandomList(),this._lastIndexCheck(),this._counter=
this._playlistItems-1):this._counter>this._playlistItems-1?(this._counter=0,g.trigger("ap_PlaylistManager.PLAYLIST_END")):0>this._counter&&(this._counter=this._playlistItems-1),g.trigger("ap_PlaylistManager.COUNTER_READY")):(this._counter>this._playlistItems-1?(this._counter=this._playlistItems-1,this._lastInOrder=!0):0>this._counter&&(this._counter=0),this._lastInOrder?g.trigger("ap_PlaylistManager.PLAYLIST_END"):g.trigger("ap_PlaylistManager.COUNTER_READY"))}},_makeRandomList:function(){3>this._playlistItems||
(this._randomArr=this._randomiseIndex(this._playlistItems))},_firstIndexCheck:function(){if(this._randomArr[0]==this._counter){var g=this._randomArr.splice(0,1);this._randomArr.push(g)}},_lastIndexCheck:function(){if(this._randomArr[this._playlistItems-1]==this._counter){var g=this._randomArr.splice(this._playlistItems-1,1);this._randomArr.unshift(g)}},_activeIndexFirst:function(){var g,e=this._randomArr.length;for(g=0;g<e;g++)if(this._randomArr[g]==this._counter){if(0==g)break;g=this._randomArr.splice(g,
1);this._randomArr.unshift(parseInt(g,10));break}},_randomiseIndex:function(g){var e=[],k=[],L;for(L=0;L<g;L++)e[L]=L;var H;for(L=0;L<g;L++)H=Math.round(Math.random()*(e.length-1)),k[L]=e[H],e.splice(H,1);return k}}})(jQuery);
(function(e){apTextScroller=function(){function e(){"left"==fa&&(Q-=F,g.css("left",Q+"px"),parseInt(g.css("left"),10)<-H&&(Q=-F))}var g,F,Ca,L,H,fa,qa,Q=0,Ra,Sa,Ta,ra,Fa=!1;this.init=function(e,k,H,Q,qa,ra){Ra=e;g=k;Ca=H;fa=Q;L=qa;F=ra};this.input=function(e){Sa=e;Ra.html(e);Ta=Ra.width();var k=e.replace(/\s/g,"&nbsp;")+L;g.html("");g.css("width","auto");g.html(k);H=g.width();if(0!=H){e=k;if(H<=2*Ca.width()){for(var F=Math.floor(2*Ca.width()/H),Q=0;Q<F;Q++)e+=k;k=H*(F+1)}else e+=k,k=2*H;g.html(e);
g.css("width",k+1+"px");ra=e;Fa=!0}};this.inputSingle=function(e){};this.activate=function(){this.deactivate();Ca.width()>=Ta?g.html(Sa):(g.html(ra),qa=setInterval(e,100))};this.deactivate=function(){qa&&clearInterval(qa);"left"==fa&&(g.css("left","0px"),Q=0)};this.checkSize=function(){Fa&&(Ca.width()>=Ta?(this.deactivate(),g.html(Sa)):(g.html(ra),this.activate()))}}})(jQuery);